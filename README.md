# Wikipedia Graph

## Usage
- Make modification in main.py to set appropriate file location
- Run the following command:
    ```
    python main.py
    ```

## How to run
- Ensure that python3 is installed in the system along with numpy , bz2, xml and re libraries
- Run the main.py file by the command python main.py


## Directory Structure
- DumpFiles
    - This folder contains the files downloaded from https://dumps.wikimedia.org/enwiki/latest/ .
    For our observation, we have used enwiki-latest-pages-articles.xml.bz2 from that folder. Other files can also be added to this folder, but its structure should be same as of the file enwiki-latest-pages-articles.xml.bz2 .
    To make graph.txt in WikiGraph folder, this folder should have the appropriate files before createWikiGraph.createWikiGraph() is called.
- WikiGraph
    - This folder has the graph.txt file which is the graph of the wikipedia pages. This file is created by the createWikiGraph.py file.
    This folder also has graph_helper.txt which is the helper file for graph.txt. This file is created by the createWikiGraph.py file.
    Note: graph.txt and graph_helper.txt are not uploaded to the repository as they are very large files. It should be generated by the main.py file after putting appropriate file in the DumpFiles.
    - graph.txt
        - This file contains graph of wikipedia pages in the form of adjacency list. The format of the file is as follows
        ```
            <Name-of-Page>
            <Number-of-category-for-the-page>
            <category-1>
            <category-2>
            .
            .
            <Number-of-outlinks-in-the-page>
            <outlink-1>
            <outlink-2>
            .
            .
        ```    
        - The sequence is repeated for all the pages in the wikipedia dump file until the end of the file.

- graph_helper.txt
    - This file contains the helper information for the graph.txt file. For each node, it stores the offset of the adjacency list in graph.txt file.
    ```
        <Name-of-Page>
        <Start-offset-of-category> <Start-offset-of-adjacency-list>
    ```
    - The sequence is repeated for all the pages in the wikipedia dump file until the end of the file.
- lib
    - This folder contains some of the helper files for the project.
    - createWikiGraph.py
        - This file contains the createWikiGraph class which is used to create the graph.txt and graph_helper.txt files.
        The class has the following methods:
            - createGraph()
                - This method creates the graph.txt and graph_helper.txt files from the dump files provided as an argument to the constructor.
            - createHelperFile()
                - This method creates the graph_helper.txt file from the dump files provided as an argument to the constructor.
                It scans the graph.txt file and stores the offset of each node in the graph_helper.txt file.
            - printStatistics()
                - This method prints the statistics of the graph.txt file.
                It prints the number of nodes, number of edges, number of categories and total time taken for making the graph.txt file.
    - randomWalk.py
        This file contains the randomWalk class which is used to perform random walk on the graph.txt file.
        
        - The class has the following methods:
            - loadGraph()
                - This method loads graph_helper.txt files provided as an argument to the constructor. It helps to get adjacency list from graph.txt file of any random node.
            - randomWalk()
                - This method performs random walk on the graph.txt file.
                It takes the following arguments:
                    - startNode
                        This is the starting node for the random walk.
                    - walkLength
                        This is the length of the random walk.
            - flushResults()
                - This method flushes the results of the random walk to the file provided as an argument to the constructor.
                It takes the following arguments:
                    - fileName
                        This is the name of the file where the results of the random walk are to be flushed.
                    - TopNodeLimit
                        This is the number of top nodes to be flushed to the file in the sorted order of number of visits.
    - \__init__.py
        - This file is used to make the lib folder as a python package.
    - \__pycache__
        - This folder contains the cache files for the lib folder.
- Results
    This folder contains the results of the random walk.
    - randomWalkResults.txt
        - This file contains the results of the random walk.
        Top nodes are displayed along with the number of visits.
    - topCategories
        - It contains the top categories in the wikipedia
- main.py
    This file is the main file of the project.
    It contains the following steps:
        - Create the graph.txt and graph_helper.txt files.  (1)
        - Perform random walk on the graph.txt file.        (2)   
        - Flush the results of the random walk to the file. (3)
    - If graph.txt is already present in the WikiGraph folder, then step (1) is skipped. Please comment out the wikiCreate.createGraph() in main.py file to skip step (1).
    - If graph_helper.txt is also present with that then comment out wikiCreate.createHelperFile() in main.py file to skip step (1).
    - If step (1) is to be skipped, then make sure that wikiCreate.completed=True is not commented out. Also, comment out wikiCreate.printStatistics() in main.py file.
    - Pass suitable arguments in the randomWalk.randomWalk() method in main.py file to perform step (2).
    - Pass suitable arguments in the randomWalk.flushResults() method in main.py file to perform step (3).
- README.md
    - This file contains the information about the project to be uploaded on the github repository.
    
    
## Observations
- The randomWalkResults.txt file contains the results of the random walk performed on the graph.txt file. It contains top 1000 nodes in the wikipedia by default. When we change TopNodeLimit we see suitable number of top pages in the result file.
- topCategories.txt shows the top 100 categories in the wikipedia. They mostly based on the topic of geopolitics, geopgraphy, wars etc.